{"remainingRequest":"/home/david/workspace/kalendar/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/david/workspace/kalendar/src/components/kalendar/kalendar-weekview.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/home/david/workspace/kalendar/src/components/kalendar/kalendar-weekview.vue","mtime":1566976249008},{"path":"/home/david/workspace/kalendar/node_modules/css-loader/index.js","mtime":1557228886204},{"path":"/home/david/workspace/kalendar/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1564752367572},{"path":"/home/david/workspace/kalendar/node_modules/sass-loader/dist/cjs.js","mtime":1566980223340},{"path":"/home/david/workspace/kalendar/node_modules/cache-loader/dist/cjs.js","mtime":1564752366860},{"path":"/home/david/workspace/kalendar/node_modules/vue-loader/lib/index.js","mtime":1564752367572}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n$blue: #5FB3F2;\n$lblue: #D6EEFC;\n$dblue: #3D79B4;\n$lightgrey: #c7c9d5; //$lightgrey: #F5F4F5;\n$grey: #c7c9d5; //#C1C4C8;\n$a-grey: #666;\n$border-color: transparent;\n$theme-color: #e5e5e5;\n\n.calendar-wrap {\n  display: flex;\n  flex-direction: column;\n\n  ul {\n    list-style: none;\n    padding: 0px;\n\n    >li {\n      display: flex;\n    }\n  }\n}\n\n.sticky-top {\n  position: sticky;\n  top: 0;\n  z-index: 20;\n  background-color: white;\n\n  .days {\n    margin: 0px;\n    display: flex;\n    margin-left: 55px;\n\n    li {\n      display: inline-flex;\n      align-items: flex-end;\n      padding-top: 10px;\n      flex: 1;\n      font-size: 1.1rem;\n      color: $a-grey;\n      font-weight: 300;\n      margin-right: var(--space-between-cols);\n      border-bottom: solid 1px #e5e5e5;\n      padding-bottom: 5px;\n      position: relative;\n      font-size: 18px;\n\n      span {\n        margin-right: 3px;\n      }\n\n      span:first-child {\n        font-size: 20px;\n        font-weight: 500;\n      }\n    }\n\n    .today {\n      border-bottom-color: var(--main-color);\n      color: var(--main-color) !important;\n    }\n\n    .today::after {\n      content: '';\n      position: absolute;\n      height: 2px;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      background-color: var(--main-color);\n    }\n  }\n\n  .all-day {\n    display: flex;\n    margin-bottom: 0px; //border-top: solid 1px #e5e5e5;\n    margin-top: 0px;\n    border-bottom: solid 2px #e5e5e5;\n\n    span {\n      display: flex;\n      align-items: center;\n      padding: 0px 5px;\n      width: 55px;\n      font-weight: 500;\n      font-size: .8rem;\n      color: darken($grey, 5);\n      text-transform: lowercase;\n    }\n\n    li {\n      flex: 1; //border-right: solid 5px $border-color;\n      margin-right: var(--space-between-cols);\n\n      &.all-today {\n        background-color: #FEF4F4;\n      }\n    }\n  }\n}\n\n.dummy-row {\n  display: flex;\n  padding-left: 55px;\n\n  ul {\n    display: flex;\n    flex: 1;\n    margin: 0px;\n  }\n\n  li {\n    flex: 1;\n    height: 15px; //border-right: solid 5px $border-color;\n    margin-right: var(--space-between-cols);\n    border-bottom: solid 1px #e5e5e5;\n  }\n}\n\n.blocks {\n  display: flex;\n  position: relative;\n  height: 100%;\n\n  ul {\n    margin-top: 0px;\n  }\n\n  .building-blocks {\n    flex: 1;\n    margin-right: var(--space-between-cols);\n    margin-bottom: 0px;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .calendar-blocks {\n    width: 100%;\n    display: flex;\n    position: relative;\n  }\n}\n\n.hours {\n  display: flex;\n  flex-direction: column;\n  color: darken($grey, 5);\n  font-weight: 500;\n  font-size: .85rem;\n  width: 55px;\n  height: 100%;\n  margin-bottom: 0px;\n\n  li {\n    color: var(--hour-row-color);\n    border-bottom: solid 1px $border-color;\n    padding-left: 8px;\n\n    span {\n      margin-top: -8px;\n    }\n\n    &:first-child span {\n      visibility: hidden;\n    }\n  }\n}\n",{"version":3,"sources":["kalendar-weekview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"kalendar-weekview.vue","sourceRoot":"src/components/kalendar","sourcesContent":["<template>\n  <div class=\"calendar-wrap\"\n       :style=\"`--space-between-cols: ${colsSpace}`\">\n    <div class=\"sticky-top\">\n      <ul class=\"days\">\n        <li class=\"day-indicator\"\n            :key=\"index\"\n            v-for=\"({value}, index) in (days || [])\"\n            :class=\"{'today': _isToday(value), 'is-before': isBefore(value)}\">\n          <div>\n            <span class=\"letters-date\">{{kalendar_options.formatDayTitle(value)[0]}}</span>\n            <span class=\"number-date\">{{kalendar_options.formatDayTitle(value)[1]}}</span>\n          </div>\n        </li>\n      </ul>\n      <ul class=\"all-day\">\n        <span>All Day</span>\n        <li :key=\"index\"\n            v-for=\"(date, index) in (days || [])\"\n            :class=\"{'all-today': _isToday(date.value), 'is-all-day': false}\"\n            :style=\"`height:${kalendar_options.cell_height + 5}px`\"></li>\n      </ul>\n    </div>\n    <div class=\"dummy-row\"\n         v-if=\"false\">\n      <ul class=\"dummy-days\">\n        <li :key=\"index\"\n            v-for=\"(day, index) in (days || [])\"\n            :style=\"`height:${kalendar_options.cell_height}px`\"></li>\n      </ul>\n    </div>\n    <div class=\"blocks\"\n         v-if=\"hours\">\n      <div class=\"calendar-blocks\">\n        <ul class=\"hours\">\n          <li class=\"hour-row-identifier\"\n              :key=\"index\"\n              v-for=\"(hour, index) in (hours || [])\"\n              v-if=\"hour.visible\"\n              :style=\"`height:${hourHeight}px`\">\n            <span>{{kalendar_options.formatLeftHours(hour.value)}}</span>\n          </li>\n        </ul>\n        <div v-show=\"kalendar_options.style !== 'material_design'\"\n             class=\"hour-indicator-line\"\n             :style=\"`top:${passedtime.distance}px`\">\n          <span class=\"time-value\">{{passedtime.value}}</span>\n          <span class=\"line\"></span>\n        </div>\n        <kalendar-days :day=\"day\"\n                       class=\"building-blocks\"\n                       :class=\"`day-${index+1}`\"\n                       :key=\"day.value.slice(0,10)\"\n                       v-for=\"(day, index) in days\"\n                       :passed-time=\"passedtime.distance\"\n                       :ref=\"day.value.slice(0,10)\">\n        </kalendar-days>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport KalendarDays from './kalendar-day.vue';\nimport myWorker from '@/components/kalendar/workers';\nimport Utils from './utils';\nconst { isBefore, isToday, getHourlessDate, addTimezoneInfo, getDatelessHour, getLocaleTime, formatAMPM } = Utils;\n\nexport default {\n  components: {\n    KalendarDays,\n  },\n  created() {\n    this.addHelperMethods();\n    setInterval(() => this.kalendar_options.now = new Date, 1000 * 60);\n    this.constructWeek();\n  },\n  inject: ['kalendar_options', 'kalendar_events'],\n  data: () => ({\n    hours: null,\n    days: []\n  }),\n  computed: {\n    colsSpace() {\n      return this.kalendar_options.style === 'flat_design' ? '5px' : '0px';\n    },\n    hourHeight() {\n      return 6 * this.kalendar_options.cell_height;\n      //this.kalendar_options.cell_height * (60 / this.kalendar_options.split_value); \n      // * this.kalendar_options.hour_parts;\n    },\n    passedtime() {\n      let { day_starts_at, day_ends_at, now } = this.kalendar_options;\n      let time = getLocaleTime(now);\n      let day_starts = `${time.split('T')[0]}T${(day_starts_at + '').padStart(2,0)}:00:00.000Z`;\n      let day_ends = `${time.split('T')[0]}T${(day_ends_at + '').padStart(2,0)}:00:00.000Z`;\n\n      console.log({ day_starts, day_ends, time });\n\n      if (new Date(day_ends) - new Date(time) < 0) {\n        return null;\n      }\n      if (new Date(time) - new Date(day_starts) < 0) {\n        return null;\n      }\n\n      let label = time.split('T')[1].slice(0, 5);\n      if (this.kalendar_options.military_time) {\n        let ampm = formatAMPM(label.split(':')[0]);\n        let ampmlabel = ampm.slice(-2);\n        console.log({ ampm });\n      }\n      let distance = ((new Date(time) - new Date(day_starts)) / 1000) / 60;\n      return { distance, time };\n    },\n  },\n  methods: {\n    _isToday(day) {\n      return isToday(day);\n    },\n    updateAppointments({ id, data }) {\n      this.$emit('update', { id, data });\n    },\n    deleteAppointment(id) {\n      this.$emit('delete', { id });\n    },\n    clearAppointments() {\n      this.$emit('clear');\n    },\n    isBefore(day) {\n      let now = new Date(this.kalendar_options.now);\n      let formattedNow = getLocaleTime(now.toISOString());\n      return isBefore(day, getHourlessDate(formattedNow));\n    },\n    constructWeek() {\n      const date = this.kalendar_options.current_day.slice(0, 10);\n      const { hide_dates, hide_days, view_type } = this.kalendar_options;\n      return Promise.all([\n        myWorker.send('getDays', {\n          day: date,\n          options: {\n            hide_dates,\n            hide_days,\n            view_type\n          }\n        }).then(reply => {\n          this.days = reply; //.slice(0,1);\n        }),\n\n        myWorker.send('getHours', {\n          hourOptions: {\n            start_hour: this.kalendar_options.day_starts_at,\n            end_hour: this.kalendar_options.day_ends_at\n          }\n        }).then(reply => {\n          // Handle the reply\n          this.hours = reply;\n        })\n      ]);\n    },\n    addHelperMethods() {\n      this.$kalendar.buildWeek = () => {\n        this.constructWeek();\n      };\n      this.$kalendar.addNewEvent = (payload) => {\n        if (!payload) return Promise.reject('No payload');\n\n        let { from, to } = payload;\n        if (from.slice(-4) === '000Z') payload.from = addTimezoneInfo(from);\n        if (to.slice(-4) === '000Z') payload.to = addTimezoneInfo(to);\n        let targetRef = payload.from.slice(0, 10);\n        const refObject = this.$refs[targetRef];\n        if (refObject && refObject[0]) {\n          refObject[0].addEvent(payload);\n        } else {\n          // appointment is not in this view\n          let events = this.$kalendar.getEvents();\n          events.push(payload);\n          this.$kalendar.updateEvents(events);\n        }\n      };\n\n      this.$kalendar.removeEvent = (options) => {\n        let { day, key, id } = options;\n        if (day.length > 10) {\n          day = day.slice(0, 10);\n        }\n        console.log('Options:', options);\n        if (!day)\n          return Promise.reject('Day wasn\\'t provided');\n        if (!id)\n          return Promise.reject('No ID was provided');\n        if (!key)\n          return Promise.reject('No key was provided in the object');\n        let targetRef = day;\n        this.$refs[targetRef][0].removeEvent({ id, key });\n      };\n\n      this.$kalendar.closePopups = () => {\n        let refs = this.days.map(day => day.value.slice(0, 10));\n        refs.forEach(ref => {\n          this.$refs[ref][0].clearCreatingLeftovers();\n        });\n      }\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n$blue: #5FB3F2;\n$lblue: #D6EEFC;\n$dblue: #3D79B4;\n$lightgrey: #c7c9d5; //$lightgrey: #F5F4F5;\n$grey: #c7c9d5; //#C1C4C8;\n$a-grey: #666;\n$border-color: transparent;\n$theme-color: #e5e5e5;\n\n.calendar-wrap {\n  display: flex;\n  flex-direction: column;\n\n  ul {\n    list-style: none;\n    padding: 0px;\n\n    >li {\n      display: flex;\n    }\n  }\n}\n\n.sticky-top {\n  position: sticky;\n  top: 0;\n  z-index: 20;\n  background-color: white;\n\n  .days {\n    margin: 0px;\n    display: flex;\n    margin-left: 55px;\n\n    li {\n      display: inline-flex;\n      align-items: flex-end;\n      padding-top: 10px;\n      flex: 1;\n      font-size: 1.1rem;\n      color: $a-grey;\n      font-weight: 300;\n      margin-right: var(--space-between-cols);\n      border-bottom: solid 1px #e5e5e5;\n      padding-bottom: 5px;\n      position: relative;\n      font-size: 18px;\n\n      span {\n        margin-right: 3px;\n      }\n\n      span:first-child {\n        font-size: 20px;\n        font-weight: 500;\n      }\n    }\n\n    .today {\n      border-bottom-color: var(--main-color);\n      color: var(--main-color) !important;\n    }\n\n    .today::after {\n      content: '';\n      position: absolute;\n      height: 2px;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      background-color: var(--main-color);\n    }\n  }\n\n  .all-day {\n    display: flex;\n    margin-bottom: 0px; //border-top: solid 1px #e5e5e5;\n    margin-top: 0px;\n    border-bottom: solid 2px #e5e5e5;\n\n    span {\n      display: flex;\n      align-items: center;\n      padding: 0px 5px;\n      width: 55px;\n      font-weight: 500;\n      font-size: .8rem;\n      color: darken($grey, 5);\n      text-transform: lowercase;\n    }\n\n    li {\n      flex: 1; //border-right: solid 5px $border-color;\n      margin-right: var(--space-between-cols);\n\n      &.all-today {\n        background-color: #FEF4F4;\n      }\n    }\n  }\n}\n\n.dummy-row {\n  display: flex;\n  padding-left: 55px;\n\n  ul {\n    display: flex;\n    flex: 1;\n    margin: 0px;\n  }\n\n  li {\n    flex: 1;\n    height: 15px; //border-right: solid 5px $border-color;\n    margin-right: var(--space-between-cols);\n    border-bottom: solid 1px #e5e5e5;\n  }\n}\n\n.blocks {\n  display: flex;\n  position: relative;\n  height: 100%;\n\n  ul {\n    margin-top: 0px;\n  }\n\n  .building-blocks {\n    flex: 1;\n    margin-right: var(--space-between-cols);\n    margin-bottom: 0px;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .calendar-blocks {\n    width: 100%;\n    display: flex;\n    position: relative;\n  }\n}\n\n.hours {\n  display: flex;\n  flex-direction: column;\n  color: darken($grey, 5);\n  font-weight: 500;\n  font-size: .85rem;\n  width: 55px;\n  height: 100%;\n  margin-bottom: 0px;\n\n  li {\n    color: var(--hour-row-color);\n    border-bottom: solid 1px $border-color;\n    padding-left: 8px;\n\n    span {\n      margin-top: -8px;\n    }\n\n    &:first-child span {\n      visibility: hidden;\n    }\n  }\n}\n</style>"]}]}